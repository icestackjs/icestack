# 生成cva函数

IceStack 内部集成了一套基于css注释的 cva 函数生成方式

## 什么是 cva (class-variance-authority)?

cva 函数是一个优秀的原子化工具函数，详见 https://cva.style/docs

## 如何生成?

我们以下方的函数为例，一个 `cva` 函数由4部分组成: `base`,`variants`,`compoundVariants`,`defaultVariants`

```js
import { cva } from 'class-variance-authority'
//                     ⬇️ base
const button = cva(['font-semibold', 'border', 'rounded'], {
  // ⬇️ variants
  variants: {
    intent: {
      primary: ['bg-blue-500', 'text-white', 'border-transparent', 'hover:bg-blue-600'],
      secondary: ['bg-white', 'text-gray-800', 'border-gray-400', 'hover:bg-gray-100']
    },
    size: {
      small: ['text-sm', 'py-1', 'px-2'],
      medium: ['text-base', 'py-2', 'px-4']
    }
  },
  // ⬇️ compoundVariants
  compoundVariants: [
    {
      intent: 'primary',
      size: 'medium',
      class: 'uppercase'
    }
  ],
  // ⬇️ defaultVariants
  defaultVariants: {
    intent: 'primary',
    size: 'medium'
  }
})

button()
// => "font-semibold border rounded bg-blue-500 text-white border-transparent hover:bg-blue-600 text-base py-2 px-4 uppercase"

button({ intent: 'secondary', size: 'small' })
// => "font-semibold border rounded bg-white text-gray-800 border-gray-400 hover:bg-gray-100 text-sm py-1 px-2"
```

## 写法

> 你可以在这里面，使用 `js` 变量来动态生成函数

比如 `type="primary"` 被称为 `query`, `["shadow-sm"]` 被称为 `params`

> 同样的 query 会和 params 被一起合并

> 注意⚠️: 如果你使用 `scss` 你可以使用下方的 `//` 进行注释，否则只使用 `css` 的话，请使用 `/*  */`

```scss
.btn {
  // @b
}
.btn-primary {
  // @v type="primary"
}
.btn-xs {
  // @v size="xs"
}
.uppercase {
  // @cv type="primary" size="xs"
}

// @dv type="primary"

// @gb ["rounded"]
// @gv type="primary" ["shadow-sm"]
// @gcv type="primary" size="xs" ["p-1"]
```

will generate:

```js
//                 ⬇️ @b and @gb
const index = cva(['btn', 'rounded'], {
  // ⬇️ variants
  variants: {
    type: {
      primary: ['btn-primary', 'shadow-sm']
    },
    size: {
      xs: ['btn-xs']
    }
  },
  // ⬇️ compoundVariants
  compoundVariants: [
    {
      type: 'primary',
      size: 'xs',
      class: ['uppercase', 'p-1']
    }
  ],
  // ⬇️ defaultVariants
  defaultVariants: {
    type: 'primary'
  }
})
```

## 参考注释

| keyword | param              | type   | description                                   |
| ------- | ------------------ | ------ | --------------------------------------------- |
| `@b`    | `base`             | node   | add current node selector to base             |
| `@v`    | `variants`         | node   | add current node selector to variants         |
| `@cv`   | `compoundVariants` | node   | add current node selector to compoundVariants |
| `@dv`   | `defaultVariants`  | global | define defaultVariants                        |
| `@gb`   | `base`             | global | define base                                   |
| `@gv`   | `variants`         | global | define variants                               |
| `@gcv`  | `compoundVariants` | global | define defaultVariants                        |
